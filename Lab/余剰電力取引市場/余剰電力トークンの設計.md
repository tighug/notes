# 余剰電力トークンの設計

## 用語説明

### トークン

**トークンとは、いくつかの共通ルールに従ったスマート・コントラクトのこと**です。具体的には、`transfer(address _to, uint256 _value)`や`balanceOf(address _owner)`などの関数のスタンダードセットを実装しているものです。お金、時間、サービス、会社の株、仮想ペットなど、現実世界の「何か」を表現するために用いられます。

### トークン規格

同じ規格を持つトークンは、同じ関数セットを所有しています。つまり、同じ方法で相互に作用することができます。そのため、ある ERC20 規格のトークンとやりとりするアプリケーションを作成した際には、他の ERC20 規格のトークンともやりとりを行う事ができます。（e.g. 取引所、ウォレット等）

### ERC

ERC（Ethereum Request for Comments）は、**Ethereum ベースで発行できるトークンの仕様を定めたもの**です。

## トークンの例

現在一般的に用いられているトークン規格は ERC20 と ERC721 の 2 つです。

### ERC20 系（Fungible Token）

分割可能で互いに交換可能なトークンです。

#### 金融

| name（symbol）                                     | description       |
| -------------------------------------------------- | ----------------- |
| [BINANCE（BNB）](https://www.binance.com/en)       | 仮想通貨取引所    |
| [Tether USD（USTD）](https://tether.to/)           | Fiat 通貨トークン |
| [Bitfinex（LEO Token）](https://www.bitfinex.com/) | 仮想通貨取引所    |
| [Ino Coin（INO）](https://inocoin.eu/)             | ICO。投資         |

#### Tech

| name（symbol）                                      | description                               |
| --------------------------------------------------- | ----------------------------------------- |
| [VeChain（VEN）](https://www.vechain.org/)          | ブロックチェーンと IoT テクノロジーに特化 |
| [BAT（BAT）](https://basicattentiontoken.org/)      | 広告。Brave との連携                      |
| [Theta Token（THETA）](https://www.thetatoken.org/) | 動画配信                                  |

### ERC721 系（Non-Fungible Token）

分割が不可能で、互いに交換が不可能なトークンです。

#### ゲーム

| name（symbol）                                      | description                                                   |
| --------------------------------------------------- | ------------------------------------------------------------- |
| [CryptoKitties (CK)](https://www.cryptokitties.co/) | 暗号子猫育成ゲーム                                            |
| [Ethereum Name Service (ENS)](https://ens.domains/) | 命名サービス。アドレスを別名で登録できる。(e.g. aardvark.eth) |
| [DozerDoll (Dozer)](https://cryptodozer.io/)        | 暗号通貨アーケードゲーム                                      |

#### その他

| name（symbol）                                      | description                                                   |
| --------------------------------------------------- | ------------------------------------------------------------- |
| [Ethereum Name Service (ENS)](https://ens.domains/) | 命名サービス。アドレスを別名で登録できる。(e.g. aardvark.eth) |

## 設計

余剰電力は分割可能で、互いに交換可能なので Fungible Token と考えられます。規格は ERC20 ではなく、[ERC777](https://eips.ethereum.org/EIPS/eip-777)を採用します。ERC777 は、ERC20 の多くの問題を解決したトークン標準であり、ERC20 とも下位互換性を持ちます。

## FAQ

### なぜ電力取引にブロックチェーンを用いるのか

**用いなくてもシステム構築は可能だが、非現実的**。具体的には、高コスト・低速・非セキュア。ブロックチェーンを用いることで、これらの問題を解決できる。また、IoT 連携などのさらなるシステム応用が可能。

### トークンを利用しなくても、電力取引は行えないか

**行えるが不便**。電力を`uint`で表現し、約定結果を元に**足し引き計算**で全てのアカウントの`uint`を更新すれば、電力取引を表現できる。

- 余剰電力をトークンとして扱う
- ~~市場は一定時間ごとに開かれるが、各市場の電力は互いに代替不可能なので、代表的な**代替不可能トークン（NFT：Non-Fungible Token）** である「**ERC 721**」を用いる~~
  - NFT は分割不可能であるため、FT を用いる
- トークンの実装には「**OpenZeppelin**」を用いる
- 標準の「~~ERC 721~~ ERC20」には、**Mint**（生成）・ **Burn**（消滅）機能は無いため拡張する

> [中部電力と Keychain、独自のトークン発行・取引基盤の実証実験を完了 ～すべての取引を暗号化し当事者以外から秘匿する分散台帳 - 仮想通貨 Watch](https://crypto.watch.impress.co.jp/docs/news/1193494.html)

| method        | description   | accessibility |
| ------------- | ------------- | ------------- |
| constructor() | Minter の登録 | public        |

```js
pragma solidity 0.5.10;

import "../node_modules/@openzeppelin/contracts/token/ERC721/ERC721.sol";
import "../node_modules/@openzeppelin/contracts/token/ERC721/ERC721Mintable.sol";
import "../node_modules/@openzeppelin/contracts/token/ERC721/ERC721Burnable.sol";

contract MyEnergy is ERC721, ERC721Mintable, ERC721Burnable {
  constructor() ERC721() ERC721Mintable() ERC721Burnable() public {
  }
}
```
